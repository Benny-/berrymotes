
<link type="text/css" href='http://sailsjs.org/styles/fonts.css' rel='stylesheet'/>

<script src="https://code.jquery.com/jquery-2.1.1.js"></script>

<script type="text/javascript">
setTimeout(function sunrise () {
    document.getElementsByClassName('header')[0].style.backgroundColor = '#118798';
}, 0);
</script>

<!-- TODO: Make a local copy of this scrip -->
<script src="http://tomasdostal.com/projects/html5ImagePreview/html5.image.preview.js"></script>

<div class="default-page">
    <div class="header">
        <h1 id="main-title" class="container"><%= __('Submit new emoticon') %></h1>
        <h3 class="container">You're looking at: <code><%= view.pathFromApp + '.' +view.ext %></code></h3>
    </div>
    <div class="main container clearfix">
        <p><%= __("Fill out this form to submit a new emoticon:") %></p>

        <% if (user.emote_subdirs.length >= 1) { %>
            <ul>
            <% user.emote_subdirs.forEach(function(subdir){ %>
                <li>You can sumbit/edit emotes in <strong><%= subdir %></strong></li>
            <% }) %>
            </ul>
        <% } else { %>
            <h2>You are not allowed to edit/create emotes in any directories. Please ask a admin for permission.</h2>
        <% } %>

        <p>You are only required to give your emoticon a unique canonical path name and a image. All other fields are optional.</p>

        <form action="/emote/submit" enctype="multipart/form-data" method="post">
            <input type='hidden' name='_csrf' value="<%= _csrf %>">
            
            <div>
                <label for="canonical_name">Canonical path*</label>

                <% if (user.emote_subdirs.length >= 1) { %>
                    <input id="canonical_name" type="text" name="canonical_name" required placeholder="bt/yourname/sorrysocks" value="<%= user.emote_subdirs[0] %>">
                <% } else { %>
                    <input id="canonical_name" type="text" name="canonical_name" required placeholder="bt/yourname/sorrysocks">
                <% } %>
            </div>
            
            <div>
                <label for="alt_text">Alt text</label>
                <input id="alt_text" type="text" name="alt_text" placeholder="Text for blind mammals or text only clients">
            </div>
            
            <div id="names_container">
                <label for="names">Name(s)</label>
                <button id="add_name">Add name</button>
            </div>
            
            <div id="css_rules_container">
                <label for="css">CSS rule(s)</label>
                <button id="add_css">Add css rule</button>
            </div>
            
            <div id="tags_container">
                <label for="tags">Tag(s)</label>
                <button id="add_tag">Add tags</button>
            </div>
            
            <div>
                <label for="src">Image source</label>
                <input id="src" type="url" name="src" placeholder="https://deviantart.com/art/Sockie-Flutter-Shy-372581382">
            </div>
            
            <div>
                <label for="emoticon_image">Emote image*</label>
                <input id="emoticon_image" type="file" name="emoticon_image" required onchange="previewImage(this,[128,64,32,16,8,4],4);">
                <div class="imagePreview"></div>
            </div>
            
            <div>
                <label for="emoticon_hover_image">Hover image</label>
                <input id="emoticon_hover_image" type="file" name="emoticon_hover_image" onchange="previewImage(this,[128,64,32,16,8,4],4);">
                <div class="imagePreview"></div>
            </div>
            
            <div>
                <input type="submit" >
                <input type="reset" >
            </div>
        </form>
        
    </div>
</div>

<script type="text/javascript">
(function() {

    var tags_container = $("#tags_container");
    var css_rules_container = $("#css_rules_container");
    var names_container = $("#names_container");
    
    $("#add_name").click(function (e) {
      names_container.append('<div><input id="names" name="names"><button  class="delete">Delete</button></div>');
      return false
    });
    
    $("#add_tag").click(function (e) {
      tags_container.append('<div><input id="tags" name="tags"><button  class="delete">Delete</button></div>');
      return false
    });
    
    $("#add_css").click(function (e) {
      css_rules_container.append('<div><input id="css" name="css"><button  class="delete">Delete</button></div>');
      return false
    });
    
    $("body").on("click", ".delete", function (e) {
        $(this).parent("div").remove();
    });

})();

</script>

